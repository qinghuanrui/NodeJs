<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Start</title>
	<link rel="shortcut icon" type="image/x-icon" href="/images/ico.ico" media="screen" />
	<link rel="stylesheet" type="text/css" href="/stylesheets/style.css"> 
</head>
<body>
	用户名：<input type="text" name="" class="login-name"><span></span><br>
	密码：<input type="password" name="" class="login-password"><span></span><br>
	<input type="button" name="" value="登录" class="login-btn">
	<a href="reg.html"><input type="button" name="" value="注册" class="login-reg"></a>

</body>
<script type="text/javascript" src="/javascripts/jquery.js"></script>
<script type="text/javascript">
//	判断是否存在
	$('.login-name').on('blur',function(){
		var username = $(this).val();
		$.ajax({
		   	type: "post",
		   	url: "../users/isUse",
		  	data: "username=" + username,
		   	dataType: "json",//后台处理后返回的数据格式
		   	beforeSend:function(){},
		   	success: function(msg){
		    	if(msg.isUse){
		    		$('.login-name').next().html('用户不存在！马上去<a href="reg.html">注册</a>');
		    		$('.login-btn').attr('disabled','disabled');
		    	}else{
		    		$('.login-name').next().html('');
		    		$('.login-btn').attr('disabled',false);
		    	}
		   }
		});
	});
//判断密码
	$('.login-btn').on("click",function(){
		var username = $('.login-name').val();
		var password = $('.login-password').val();

		$.ajax({
		   	type: "post",
		   	url: "../users/login",
		   	data: "username=" + username + "&password=" + password,
		   	dataType: "json",//后台处理后返回的数据格式
		   	beforeSend:function(){
		   		$('.login-password').next().html('正在验证...');
		   	},
		   	success: function(msg){
		   		$('.login-password').next().html('');
		    	// console.log(msg[0]);
		    	if(msg[0].password != password){
		    		$('.login-password').next().html('密码错误!');
		    	}else{
		    		$('.login-password').next().html('');
		    		alert('登录成功！')
		    	}
		   	}
		});
	})
</script>
</html>